# NLP 4th course final project
Ksenia Revak, Anna Tkach

В репозитории содержатся файлы, используемые нами в финальном проекте по курсу «Автоматическая обработка языка». Файл model – обученная модель, training.ipynb – код обучения модели, task_1_and_2.ipynb – выделение эксплицитных аспектов и их тональности, task_3.ipynb – тональность всего отзыва по аспектам, evaluation.ipynb – оценка качества разметки. 


Корпус, разметка, готовая модель
При обучении мы использовали разметку тренировочных данных по аспектам (эксплицитным), представленным в изначальных данных (train_split из данного нам файла train_aspects). Для присваивания тональности эксплицитным аспектам мы использовали готовую модель, дообученную на данных SemEval (https://huggingface.co/yangheng/deberta-v3-large-absa-v1.1). 

Методы
2.1 Для выделения упоминаний эксплицитных аспектов мы использовали подход bi-lstm+crf (код основан на туториале https://pytorch.org/tutorials/beginner/nlp/advanced_tutorial.html). Для разметки последовательности мы использовали теги категорий (Whole, Interior, Service, Food, Price), присвоенные токенам в соответствии с тренировочными данными. 
2.2 Для разметки тональности эксплицитных аспектов мы использовали готовую модель (deberta-v3-large-absa-v1.1). Мы оценивали тональность для каждой пары (эксплицитный аспект, отзыв). Также мы попробовали оценивать тональность по парам вида (эксплицитный аспект, его предложение), но качество на тестовой (dev) выборке получилось ниже. 
2.3 Для определения тональности всего отзыва по аспектным категориям мы использовали метод подсчета (для каждой из категорий отбирали эксплицитные аспекты, которые относятся к ней, и смотрели, встречаются ли только с положительной тональностью, только с отрицательной или оба типа). 

Результаты и анализ ошибок

3.1 Выделение эксплицитных аспектов: 

Full match precision: 0.8065359477124183
Full match recall: 0.5291595197255574
Partial match ratio in pred: 0.869281045751634
Full category accuracy: 0.726797385620915
Partial category accuracy: 0.8588235294117647

Можно заметить, что у нас получилась очень низкая полнота. Это из-за того, что мы учитываем только эксплицитные аспекты из одного токена. 

3.2  Определение тональности эксплицитных аспектов: 

Mention sentiment accuracy: 0.7112561174551386
Mention sentiment accuracy: 0.5897435897435898

3.3 Определение тональности отзыва по аспектным категориям 
Overall sentiment accuracy: 0.3352112676056338

Такая низкая accuracy получилась из-за того, что при выделении эксплицитных аспектов низкая полнота: так как многие эксплицитные аспекты просто не выделяются нашей моделью, здесь при подсчете категории часто (ошибочно) присваивается значение тональности ‘Absence’. 


Инструкция по запуску 

Для получения результата на тестовых данных задачи 3 – файл ‘task_3’, на входе подается результат выполнения тетрадки 'tasks_1_and_2' (файл с выделением эксплицитных аспектов и их тональностей). 

Для получения результата для задач 1 и 2 – код в тетрадке 'tasks_1_and_2'. К сожалению, для инициализации и использования нашей модели необходимы некоторые тренировочные данные, поэтому там довольно много ячеек с кодом. В тетрадке отмечено, где нужно поменять путь к файлу с входными (тестовыми) данными. 

